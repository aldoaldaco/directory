<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../contact-item/contacts-item.html">
<dom-module id="contacts-list">
    <template>
        <style>
            contacts-item {
                width: 100%;
                height: 10%;
                background-color: #CCCCCC;
            }
        </style>
        <template is="dom-repeat" items="{{contacts}}">
            <contacts-item on-click="contactSelected" contact="[[item]]"></contacts-item>
        </template>
    </template>
    <script>
        (function contactsListDefinition(customElements) {
            'use strict';

            class ContactsList extends ReduxMixin(Polymer.Element) {
                static get is() {
                    return 'contacts-list';
                }

                connectedCallback() {
                    super.connectedCallback();
                    fetch('/offline_resources/descarga.json')
                    // fetch('https://randomuser.me/api/?results=10')
                        .then(request => {
                            return request.json();
                        })
                        .then(data => {
                            data.results.forEach(result => {
                                this.push('contacts', result);
                            });
                        })
                        .catch(error => {
                            console.log('Bad request loaded.');
                        });
                }

                static get properties() {
                    return {
                        contacts: {
                            type: Array,
                            statePath: 'contacts'
                        },
                        selected: {
                            type: Boolean,
                            value: true,
                            notify: true
                        }

                    }
                }

                contactSelected(e) {
                    this.dispatchEvent(new CustomEvent('contact-selected', {
                        bubbles: true,
                        composed: true,
                        detail: {
                            item: e.model.item,
                            selected: this.selected
                        }
                    }));
                }
            }

            customElements.define(ContactsList.is, ContactsList);
        })(window.customElements);
    </script>
</dom-module>
